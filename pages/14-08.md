# Relatório de Estudos

Gabriel Faria e Silva

14/08/2024

**Módulos vistos:**

- Linux / Shell

# Resumo dos módulos

## Linux / Shell
Shell é uma interface de usuário para sistemas operacionais baseados em Unix. Pode interpretar comandos e executar outros programas, acessar arquivos, utilidades, aplicações e etc. É uma linguagem de "script" interativa.

Comandos Linux Shell são usados para navegar e trabalhar com arquivos e diretórios.

### Bash
Bash é um interpretador de comandos para Shell e Bash Script é um arquivo de texto escrito utilizando comandos Bash. O caractere "$" precedendo comandos indica o prompt de linha de comando Bash.

#### Bash Script
Tenhamos um Bash Script de nome **myscript** que contenha o seguinte conteúdo:

    echo "Hello World!"

    //Um dos comandos mais básicos de toda a linguagem é aquele que imprime (printa) algo na tela. No script shell, isso é possível pelo comando "echo".

Existem duas formas de executar um arquivo Bash Script. A primeira forma é passar o nome do arquivo como um parâmetro do executável **bash**.

    $ bash myscript
    >> Hello World! //Output

A segunda forma é modificar o nível de acesso do arquivo, o transformando em um executável por si só:
 
    //Altera a permissão de arquivos -> '+': adição de permissões; 'x': execução.
    $ chmod +x ./myscript

    //Executa o arquivo
    $ ./myscript

#### Shebang header
Apesar de o Bash por si só ser um interpretador de comandos, um Bash Script pode ser executado por outros interpretadores instalados no PC do usuário.

A definição de qual vai ser o interpretador utilizado se dá na primeira linha do Script, chamada de **Script Header** ou **Shebang**.

Um **Shebang** inicia com o caractere "#":

    #!/usr/bin/bash

    //Diz para o sistema utilizar o interpretador localizado no caminho /usr/bin/bash

Dessa forma, é possível executar um Script em diversas linguagens de programação, desde que seus respectivo interpretadores estejam instalados na máquina do usuário.

#### Variáveis
A declaração de uma variável segue o padrão:

    NOME_DA_VARIAVEL=valor

E para referenciar a variável no código:

    echo $NOME_DA_VARIAVEL

    //De exemplo, printa o valor contido na variável

#### Manipulação de Strings
É possível manipular Strings via **Expansão de Parâmetros**, dada pela sintaxe:

    ${NOME_DA_VARIAVEL parametro parametro}

Os dois parâmetros subsequentes alteram o valor da variável passada, por exemplo:

    MSG="aBcDeF"

    echo ${MSG^^}

    >> ABCDEF //Output

O comando acima, por conta dos dois "^", transforma todos os caracteres da variável "MSG" em letra maiúscula.

Da mesma forma, é possível transformar todos os caracteres em letra minúscula:

    echo ${MSG,,}

    >> abcdef //Output

Para trocar palavras utilizar "/":

    MSG="Say hi to Chris and Sidney"

    echo ${MSG//Chris/Billy}

    >> Say hi to Billy and Sidney //Output

Mesmo caso, utilizando expressões regulares:

    MSG="I need 10"

    echo ${MSG//[a-zA-Z]/X}

    >> X XXXX 10 //Output

No exemplo acima, todas as letras em minúsculo (a-z) e em maiúsculo (A-Z), ou seja, todas as letras no geral, são trocadas pelo caractere "X".
___

### Shell em uma pipeline ETL
#### Extraindo dados via comandos echo / cut
    echo database
    >> database //Output

É possível extrair caracteres ou campos específicos de uma linha de texto pelo comando de filtro "cut", junto com o "echo":

    echo database | cut -c1-4
    >> data //Output

No exemplo acima, foi passado como parâmetro ao comando "cut" que somente os caracteres de 1 a 4 de "database" (printado pelo comando "echo") seriam printados na tela.

O mesmo pode ser feito para extrair os caracteres de 5 a 8, por exemplo:

    echo database | cut -c5-8
    >> base //Output

E também para extrair caracteres não-contínuos, usando uma vírgula ",":

    echo database | cut -c1,5
    >> db //Output

Até agora apenas caracteres específicos foram selecionados, porém, o mesmo pode ser feito com colunas / campos de um arquivo.

O comando cut aceita outros dois argumentos:
- -d"delimitador" -> especifica o tipo de delimitador de campos em um arquivo. Por exemplo: se um arquivo tem informações separadas por uma vírgula "," (como em um arquivo CSV), no lugar do delimitador, a vírgula "," seria passada como argumento.
- -fx -> onde "x" é o número de campos (colunas) a serem trazidos. Por exemplo, se quiser extrair apenas a primeira coluna do arquivo, o parâmetro será "f1".

O arquivo "passwd" é um dataset de exemplo que contém 6 colunas, delimitadas cada uma por dois pontos ":".

_OBS: o arquivo "passwd" localizado na pasta "/etc" é só um exemplo que estava no curso que fiz. No lugar poderia estar qualquer outro arquivo._

    cut -d":" -f1 /etc/passwd //Traz a primeira coluna do dataset que tem por delimitador ":"
    >> root
       daemon
       bin
       sys
       sync
       games
       man
       lp
       mail
       news
       uucp
       ...
    
Extraindo várias colunas do mesmo dataset:

    cut -d":" -f1,3,6 /etc/passwd //Traz as colunas 1,3,6 do dataset
    >> root:0:/root
       daemon:1:/usr/sbin
       bin:2:/bin
       sys:3:/dev
       sync:4:/bin
       games:5:/usr/games
       man:6:/var/cache/man
       lp:7:/var/spool/lpd
       mail:8:/var/mail
       news:9:/var/spool/news
       uucp:10:/var/spool/uucp
       ...